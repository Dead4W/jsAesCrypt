AesCrypt=function(){let e={version:"0.13a",bufferSize:32768,fileFormatVersion:2,maxPassLen:1024,AESBlockSize:16};var t=function(e){let t=0,r=e.size,o=new FileReader,i=e;async function a(e){return await function(e){return new Promise((n,r)=>{let a=i.slice(t,t+=e);o.onload=(()=>{n(new Uint8Array(o.result))}),o.onerror=r,o.readAsArrayBuffer(a)})}(e)}return{readByte:async function(){return(await a(1))[0]},readBytes:a,readBytesAsInt:async function(e){let t=await a(e);return n.arrToInt(t)},readBytesAsString:async function(e){let t=await a(e);return n.bytes_to_latin1(t)},getCurrentPosition:function(){return t},getLength:function(){return r}}},n={random_int:function(e,t){return Math.floor(Math.random()*(t-e)+e)},urandom:function(e){let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(this.random_int(0,256));return t},fillArray:function(e,t){let n=[];for(let r=0;r<t;r++)n.push(e);return n},arrToInt:function(e){return parseInt(Array.prototype.map.call(e,e=>("00"+e.toString(16)).slice(-2)).join(""),16)},bytes_to_latin1:function(e){return CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Uint8Arr.parse(e))},encode_to_words:function(e,t="Latin1"){return CryptoJS.enc[t].parse(e)}};let r=function(){let e=new Uint8Array([]);return{appendBytes:function(t){let n;if("number"==typeof t){let e=t.toString(16);n=new Uint8Array(e.match(/.{1,2}/g).map(e=>parseInt(e,16)))}else if("string"==typeof t){n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e)}else n=new Uint8Array(t);let r=new Uint8Array(e.length+n.length);r.set(e),r.set(n,e.length),e=r},finalize:function(){return e}}};function o(e,t){return CryptoJS.algo.AES.createEncryptor(n.encode_to_words(e),{mode:CryptoJS.mode.CBC,iv:CryptoJS.enc.Latin1.parse(t),padding:CryptoJS.pad.NoPadding})}function i(e,t){return CryptoJS.algo.AES.createDecryptor(n.encode_to_words(e),{mode:CryptoJS.mode.CBC,iv:CryptoJS.enc.Latin1.parse(t),padding:CryptoJS.pad.NoPadding})}function a(e,t){let r=n.encode_to_words(t+"\0".repeat(16));for(let t=0;t<8192;t++){let t=CryptoJS.algo.SHA256.create();t.update(r),t.update(n.encode_to_words(e,"Utf16LE")),r=t.finalize()}return r.toString(CryptoJS.enc.Latin1)}return Uint8Array.prototype.appendBytes=function(e){let t;if("number"==typeof e){let n=e.toString(16);t=new Uint8Array(n.match(/.{1,2}/g).map(e=>parseInt(e,16)))}else if("string"==typeof e){t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n)}else t=new Uint8Array(e);let n=new Uint8Array(this.length+t.length);return n.set(this),n.set(t,this.length),n},{encrypt:async function(i,s,l=(e=>{})){if(s.length>e.maxPassLen)return console.warn("Password is too long."),!1;const p=n.urandom(e.AESBlockSize),c=a(s,p),d=n.urandom(e.AESBlockSize),y=n.urandom(32),u=o(y,d),S=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,n.encode_to_words(y)),f=o(c,p),g=f.process(n.encode_to_words(d+y)).toString(CryptoJS.enc.Latin1)+f.finalize().toString(CryptoJS.enc.Latin1),w=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,n.encode_to_words(c));return w.update(n.encode_to_words(g)),await async function(o,i,a,s,l,p,c){let d=r();d.appendBytes("AES"),d.appendBytes(e.fileFormatVersion),d.appendBytes(0);const y="jsAesCrypt "+e.version;d.appendBytes(0),d.appendBytes(1+("CREATED_BY"+y).length),d.appendBytes("CREATED_BY"),d.appendBytes(0),d.appendBytes(y),d.appendBytes([0,128]),d.appendBytes(n.fillArray(0,128)),d.appendBytes([0,0]),d.appendBytes(i),d.appendBytes(a),d.appendBytes(l.finalize().toString(CryptoJS.enc.Latin1));let u=String.fromCharCode(0),S=new t(o);Math.ceil(S.getLength()/e.bufferSize);let f=Math.ceil((S.getLength()-S.getCurrentPosition())/e.bufferSize),g=0;for(;S.getCurrentPosition()<S.getLength();){let t=await S.readBytes(e.bufferSize),r=t.length,o=p.process(n.encode_to_words(t,"Uint8Arr")).toString(CryptoJS.enc.Latin1);if(r<e.bufferSize){let t;u=String.fromCharCode(r%e.AESBlockSize),t=r%e.AESBlockSize==0?0:16-r%e.AESBlockSize;let i=u.repeat(t);o+=p.process(n.encode_to_words(i)).toString(CryptoJS.enc.Latin1)}o+=p.finalize().toString(CryptoJS.enc.Latin1),s.update(n.encode_to_words(o)),d.appendBytes(o),c(++g/f)}return d.appendBytes(u),d.appendBytes(s.finalize().toString(CryptoJS.enc.Latin1)),await d.finalize()}(i,p,g,S,w,u,l)},decrypt:async function(o,s,l=(e=>{})){if(s.length>e.maxPassLen)return console.warn("Password is too long."),!1;let p=t(o);if("AES"!==await p.readBytesAsString(3)||p.getLength()<136)return console.warn("File is corrupted or not an AES Crypt \n(or jsAesCrypt) file."),!1;if(await p.readByte()!==e.fileFormatVersion)return console.warn("jsAesCrypt is only compatible with version \n2 of the AES Crypt file format."),!1;for(await p.readByte();;){let e=await p.readBytes(2);if(e.length<2)return console.warn("File is corrupted."),!1;if(0==(e=+n.arrToInt(e)))break;await p.readBytes(e)}let c=await p.readBytesAsString(16);if(16!==c.length)return console.warn("File is corrupted."),!1;let d=a(s,c),y=await p.readBytesAsString(48);if(48!==y.length)return console.warn("File is corrupted."),!1;let u=await p.readBytesAsString(32);if(32!==u.length)return console.warn("File is corrupted."),!1;let S=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,n.encode_to_words(d));if(S.update(n.encode_to_words(y)),u!==CryptoJS.enc.Latin1.stringify(S.finalize()))return console.warn("Wrong password (or file is corrupted)."),!1;let f=i(d,c),g=f.process(n.encode_to_words(y)).toString(CryptoJS.enc.Latin1)+f.finalize().toString(CryptoJS.enc.Latin1),w=g.substr(0,e.AESBlockSize),C=g.substr(e.AESBlockSize,32),A=i(C,w),B=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,n.encode_to_words(C)),h=r(),_=Math.ceil((p.getLength()-p.getCurrentPosition()-32-1-e.AESBlockSize)/e.bufferSize)+1,J=0;for(;p.getCurrentPosition()<p.getLength()-32-1-e.AESBlockSize;){let t=n.encode_to_words(await p.readBytes(Math.min(e.bufferSize,p.getLength()-p.getCurrentPosition()-32-1-e.AESBlockSize)),"Uint8Arr");B.update(t),h.appendBytes(A.process(t).toString(CryptoJS.enc.Latin1)),l(++J/_)}var z;if(p.getCurrentPosition()!==p.getLength()-32-1){if((z=await p.readBytes(e.AESBlockSize)).length<e.AESBlockSize)return console.warn("File is corrupted."),!1}else z=new Uint8Array([]);z=n.encode_to_words(z,"Uint8Arr"),B.update(z);let L=await p.readBytesAsInt(1),m=A.process(z).toString(CryptoJS.enc.Latin1)+A.finalize().toString(CryptoJS.enc.Latin1),E=(16-L)%16;0!==E&&(m=m.substr(0,m.length-E)),h.appendBytes(m);let U=await p.readBytesAsString(32);return 32!==U.length?(console.warn("File is corrupted."),!1):U!==CryptoJS.enc.Latin1.stringify(B.finalize())?(console.warn("Bad HMAC (file is corrupted)."),!1):(l(1),h.finalize())},utils:n,getInfo:function(){return e}}};