AesCrypt=function(){let e={version:"0.12a",bufferSize:16777216,fileFormatVersion:2,maxPassLen:1024,AESBlockSize:16};var t=function(e){let t=0,n=e.size,o=new FileReader,i=e;async function a(e){return await function(e){return new Promise((r,n)=>{let a=i.slice(t,t+=e);o.onload=(()=>{r(new Uint8Array(o.result))}),o.onerror=n,o.readAsArrayBuffer(a)})}(e)}return{readByte:async function(){return(await a(1))[0]},readBytes:a,readBytesAsInt:async function(e){let t=await a(e);return r.arrToInt(t)},readBytesAsString:async function(e){let t=await a(e);return r.bytes_to_latin1(t)},getCurrentPosition:function(){return t},getLength:function(){return n}}},r={random_int:function(e,t){return Math.floor(Math.random()*(t-e)+e)},urandom:function(e){let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(this.random_int(0,256));return t},fillArray:function(e,t){let r=[];for(let n=0;n<t;n++)r.push(e);return r},arrToInt:function(e){return parseInt(Array.prototype.map.call(e,e=>("00"+e.toString(16)).slice(-2)).join(""),16)},bytes_to_latin1:function(e){return CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Uint8Arr.parse(e))},encode_to_words:function(e,t="Latin1"){return CryptoJS.enc[t].parse(e)}};function n(e,t){return CryptoJS.algo.AES.createEncryptor(r.encode_to_words(e),{mode:CryptoJS.mode.CBC,iv:CryptoJS.enc.Latin1.parse(t),padding:CryptoJS.pad.NoPadding})}function o(e,t){return CryptoJS.algo.AES.createDecryptor(r.encode_to_words(e),{mode:CryptoJS.mode.CBC,iv:CryptoJS.enc.Latin1.parse(t),padding:CryptoJS.pad.NoPadding})}function i(e,t){let n=r.encode_to_words(t+"\0".repeat(16));for(let t=0;t<8192;t++){let t=CryptoJS.algo.SHA256.create();t.update(n),t.update(r.encode_to_words(e,"Utf16LE")),n=t.finalize()}return n.toString(CryptoJS.enc.Latin1)}return Uint8Array.prototype.appendBytes=function(e){let t;if("number"==typeof e){let r=e.toString(16);t=new Uint8Array(r.match(/.{1,2}/g).map(e=>parseInt(e,16)))}else if("string"==typeof e){t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r)}else t=new Uint8Array(e);let r=new Uint8Array(this.length+t.length);return r.set(this),r.set(t,this.length),r},{encrypt:async function(o,a){if(a.length>e.maxPassLen)return console.warn("Password is too long."),!1;const s=r.urandom(e.AESBlockSize),p=i(a,s),c=r.urandom(e.AESBlockSize),l=r.urandom(32),d=n(l,c),y=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,r.encode_to_words(l)),S=n(p,s),u=S.process(r.encode_to_words(c+l)).toString(CryptoJS.enc.Latin1)+S.finalize().toString(CryptoJS.enc.Latin1),f=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,r.encode_to_words(p));return f.update(r.encode_to_words(u)),await async function(n,o,i,a,s,p){let c=new Uint8Array([]);c=(c=(c=c.appendBytes("AES")).appendBytes(e.fileFormatVersion)).appendBytes(0);const l="jsAesCrypt "+e.version;c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=c.appendBytes(0)).appendBytes(1+("CREATED_BY"+l).length)).appendBytes("CREATED_BY")).appendBytes(0)).appendBytes(l)).appendBytes([0,128])).appendBytes(r.fillArray(0,128))).appendBytes([0,0])).appendBytes(o)).appendBytes(i)).appendBytes(s.finalize().toString(CryptoJS.enc.Latin1));let d=String.fromCharCode(0),y=new t(n);for(Math.ceil(y.getLength()/e.bufferSize);y.getCurrentPosition()<y.getLength();){let t=await y.readBytes(e.bufferSize),n=t.length,o=p.process(r.encode_to_words(t,"Uint8Arr")).toString(CryptoJS.enc.Latin1);if(n<e.bufferSize){let t;d=String.fromCharCode(n%e.AESBlockSize),t=n%e.AESBlockSize==0?0:16-n%e.AESBlockSize;let i=d.repeat(t);o+=p.process(r.encode_to_words(i)).toString(CryptoJS.enc.Latin1)}o+=p.finalize().toString(CryptoJS.enc.Latin1),a.update(r.encode_to_words(o)),c=c.appendBytes(o)}return c=(c=c.appendBytes(d)).appendBytes(a.finalize().toString(CryptoJS.enc.Latin1)),await c}(o,s,u,y,f,d)},decrypt:async function(n,a){if(a.length>e.maxPassLen)return console.warn("Password is too long."),!1;let s=t(n);if("AES"!==await s.readBytesAsString(3)||s.getLength()<136)return console.warn("File is corrupted or not an AES Crypt \n(or jsAesCrypt) file."),!1;if(await s.readByte()!==e.fileFormatVersion)return console.warn("jsAesCrypt is only compatible with version \n2 of the AES Crypt file format."),!1;for(await s.readByte();;){let e=await s.readBytes(2);if(e.length<2)return console.warn("File is corrupted."),!1;if(0==(e=+r.arrToInt(e)))break;await s.readBytes(e)}let p=await s.readBytesAsString(16);if(16!==p.length)return console.warn("File is corrupted."),!1;let c=i(a,p),l=await s.readBytesAsString(48);if(48!==l.length)return console.warn("File is corrupted."),!1;let d=await s.readBytesAsString(32);if(32!==d.length)return console.warn("File is corrupted."),!1;let y=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,r.encode_to_words(c));if(y.update(r.encode_to_words(l)),d!==CryptoJS.enc.Latin1.stringify(y.finalize()))return console.warn("Wrong password (or file is corrupted)."),!1;let S=o(c,p),u=S.process(r.encode_to_words(l)).toString(CryptoJS.enc.Latin1)+S.finalize().toString(CryptoJS.enc.Latin1),f=u.substr(0,e.AESBlockSize),g=u.substr(e.AESBlockSize,32),w=o(g,f),C=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,r.encode_to_words(g)),A=new Uint8Array([]);for(;s.getCurrentPosition()<s.getLength()-32-1-e.AESBlockSize;){let t=r.encode_to_words(await s.readBytes(Math.min(e.bufferSize,s.getLength()-s.getCurrentPosition()-32-1-e.AESBlockSize)),"Uint8Arr");C.update(t),A=A.appendBytes(w.process(t).toString(CryptoJS.enc.Latin1))}var B;if(s.getCurrentPosition()!==s.getLength()-32-1){if((B=await s.readBytes(e.AESBlockSize)).length<e.AESBlockSize)return console.warn("File is corrupted."),!1}else B=new Uint8Array([]);B=r.encode_to_words(B,"Uint8Arr"),C.update(B);let _=await s.readBytesAsInt(1),h=w.process(B).toString(CryptoJS.enc.Latin1)+w.finalize().toString(CryptoJS.enc.Latin1),J=(16-_)%16;0!==J&&(h=h.substr(0,h.length-J)),A=A.appendBytes(h);let L=await s.readBytesAsString(32);return 32!==L.length?(console.warn("File is corrupted."),!1):L!==CryptoJS.enc.Latin1.stringify(C.finalize())?(console.warn("Bad HMAC (file is corrupted)."),!1):A},getInfo:function(){return e}}};