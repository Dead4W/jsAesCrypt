aesCrypt=function(){let e={version:"0.15",bufferSize:32768,fileFormatVersion:2,maxPassLen:1024,AESBlockSize:16};const t={urandom:e=>crypto.getRandomValues(new Uint8Array(e)),arrToInt:e=>parseInt(Array.prototype.map.call(e,e=>("00"+e.toString(16)).slice(-2)).join(""),16),bytes2str:e=>CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Uint8Arr.parse(e)),str2bytes:(e,t="Latin1")=>CryptoJS.enc.Uint8Arr.decode(CryptoJS.enc[t].parse(e))};const n={createKey:async(e,t,n)=>await crypto.subtle.importKey("raw",e.buffer,t,!1,n),async webHashHMAC(e,t){let n=await this.createKey(t,{name:"HMAC",hash:{name:"SHA-256"}},["sign","verify"]);return new Uint8Array(await crypto.subtle.sign("HMAC",n,e))},async webEncryptAes(e,t,n,r=!0){let a=await this.createKey(t,"AES-CBC",["encrypt","decrypt"]),i=new Uint8Array(await crypto.subtle.encrypt({name:"AES-CBC",iv:n},a,e));return e.length%this.info.AESBlockSize==0&&!0===r&&(i=i.slice(0,i.length-this.info.AESBlockSize)),i},webHashSHA256:async e=>new Uint8Array(await crypto.subtle.digest("SHA-256",e.buffer)),async webDecryptAes(e,t,n,r=0){let i=await this.createKey(t,"AES-CBC",["encrypt","decrypt"]),s=a(e);if(0===r){let r=[];for(let t=0;t<this.info.AESBlockSize;t++)r.push(0^e[e.length-this.info.AESBlockSize+t]);s.appendBytes(await this.webEncryptAes(new Uint8Array(r),t,n,!1))}let o=new Uint8Array(await crypto.subtle.decrypt({name:"AES-CBC",iv:n},i,s.finalize()));return 0==r&&(o=o.slice(0,o.length-this.info.AESBlockSize)),o}},r=function(e){let t=0,n=e.size,r=new FileReader,a=e;async function i(e){return await function(e){return new Promise((n,i)=>{let s=a.slice(t,t+=e);r.onload=(()=>{n(new Uint8Array(r.result))}),r.onerror=i,r.readAsArrayBuffer(s)})}(e)}return{readByte:async function(){return(await i(1))[0]},readBytes:i,getCurrentPosition:function(){return t},getLength:function(){return n}}},a=function(e=[]){let t=new Uint8Array(e);return{appendBytes:function(e){let n;if("number"==typeof e){let t=e.toString(16);n=new Uint8Array(t.match(/.{1,2}/g).map(e=>parseInt(e,16)))}else if("string"==typeof e){n=new Uint8Array(e.length);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t)}else n=new Uint8Array(e);let r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),t=r},finalize:function(){return t},get:function(e){return t[e]},getLength:function(){return t.length}}};async function i(e,r){let i=a();i.appendBytes(r),i.appendBytes("\0".repeat(16)),i=i.finalize();for(let r=0;r<8192;r++){let r=a(i);r.appendBytes(t.str2bytes(e,"Utf16LE")),i=await n.webHashSHA256(r.finalize(0))}return i}return n.info=e,{encrypt:async function(s,o){if(o.length>e.maxPassLen)throw"Password is too long.";const y=t.urandom(e.AESBlockSize),l=await i(o,y),c=t.urandom(e.AESBlockSize),p=t.urandom(32);let w=a();w.appendBytes(c),w.appendBytes(p),w=await n.webEncryptAes(w.finalize(),l,y);const f=await n.webHashHMAC(w,l);return await async function(t,i,s,o,y,l){let c=a();c.appendBytes("AES"),c.appendBytes(e.fileFormatVersion),c.appendBytes(0);const p="jsAesCrypt "+e.version;c.appendBytes(0),c.appendBytes(1+("CREATED_BY"+p).length),c.appendBytes("CREATED_BY"),c.appendBytes(0),c.appendBytes(p),c.appendBytes([0,128]),c.appendBytes("\0".repeat(128)),c.appendBytes([0,0]),c.appendBytes(i),c.appendBytes(s),c.appendBytes(y);let w=new r(t),f=w.getLength(),d=a(await w.readBytes(w.getLength())),A=String.fromCharCode(f%e.AESBlockSize);return cText=await n.webEncryptAes(d.finalize(),o,l),hmac0=await n.webHashHMAC(cText,o),c.appendBytes(cText),c.appendBytes(A),c.appendBytes(hmac0),await c.finalize()}(s,y,w,p,f,c)},decrypt:async function(s,o){if(o.length>e.maxPassLen)throw"Password is too long.";let y=r(s);if("AES"!==t.bytes2str(await y.readBytes(3))||y.getLength()<136)throw"File is corrupted or not an AES Crypt \n(or jsAesCrypt) file.";if(await y.readByte()!==e.fileFormatVersion)throw"jsAesCrypt is only compatible with version \n2 of the AES Crypt file format.";for(await y.readByte();;){let e=await y.readBytes(2);if(e.length<2)throw"File is corrupted.";if(0==(e=+t.arrToInt(e)))break;await y.readBytes(e)}let l=await y.readBytes(16);if(16!==l.length)throw"File is corrupted.";let c=await i(o,l),p=await y.readBytes(48);if(48!==p.length)throw"File is corrupted.";let w=t.bytes2str(await y.readBytes(32));if(32!==w.length)throw"File is corrupted.";let f=await n.webHashHMAC(p,c);if(w!==t.bytes2str(f))throw"Wrong password (or file is corrupted).";let d,A=(p=await n.webDecryptAes(p,c,l,0)).slice(0,e.AESBlockSize),h=p.slice(e.AESBlockSize,e.AESBlockSize+32),u=a(),B=a(await y.readBytes(y.getLength()-y.getCurrentPosition()-32-1)),g=t.arrToInt(await y.readBytes(1));hmac0Act=await n.webHashHMAC(B.finalize(),h);try{d=await n.webDecryptAes(B.finalize(),h,A,g)}catch{d=await n.webDecryptAes(B.finalize(),h,A,0);let t=e.AESBlockSize-g;d=d.slice(0,d.length-t)}u.appendBytes(d);let S=t.bytes2str(await y.readBytes(32));if(32!==S.length)throw"File is corrupted.";if(S!==t.bytes2str(hmac0Act))throw"Bad HMAC (file is corrupted).";return u.finalize()},utils:t,info:e}};